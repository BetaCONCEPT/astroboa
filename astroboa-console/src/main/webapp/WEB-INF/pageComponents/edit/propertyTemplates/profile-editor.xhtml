<?xml version="1.0" encoding="UTF-8"?>
<!-- 

Copyright (C) 2005-2011 BetaCONCEPT LP.

		  This file is part of Astroboa.
		 
		  Astroboa is free software: you can redistribute it and/or modify
		  it under the terms of the GNU Lesser General Public License as published by
		  the Free Software Foundation, either version 3 of the License, or
		  (at your option) any later version.
		 
		  Astroboa is distributed in the hope that it will be useful,
		  but WITHOUT ANY WARRANTY; without even the implied warranty of
		  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
		  GNU Lesser General Public License for more details.
		 
		  You should have received a copy of the GNU Lesser General Public License
		  along with Astroboa.  If not, see <http://www.gnu.org/licenses/>.
		 
Authors 
		  Gregory Chomatas (gchomatas@betaconcept.com)
		  Savvas Triantafyllou (striantafyllou@betaconcept.com)
		 		    
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:seam="http://jboss.com/products/seam/taglib">

	<body>
		<ui:composition>
					<a4j:repeat 
						value="#{complexCmsPropertyEdit.editedCmsProperties}"
						var="cmsPropertyWrapper"
						rowKeyVar="indexOfCmsPropertyWrapper"
						ajaxKeys="#{complexCmsPropertyEdit.wrapperIndexesToUpdate}">
						
						<a4j:outputPanel id="objectProperty" >
							<!--  If user has no access we do not show the field --> 
							<ui:fragment rendered="#{cmsPropertyWrapper.readGranted or cmsPropertyWrapper.writeGranted}">
								
										<li class="formElement">
											<label id="#{cmsPropertyWrapper.cmsPropertyDefinition.fullPath}" class="propertyTip">
												<a4j:commandLink
													onclick="destroyTextEditor(); codeEditorAreas=[]; editAreaLoader.prepare_areas_for_betacms_submit('dynamicAreaForm');"
													rendered="#{cmsPropertyWrapper.valueType eq 'Complex' 
														and ! cmsPropertyWrapper.multiple}"
													action="#{contentObjectEdit.showSelectedComplexPropertyForPath_UIAction(cmsPropertyWrapper.path)}"
													reRender="profilePropertiesPanel,objectFormHeader">
											
													<h:outputText
														value="#{(cmsPropertyWrapper.mandatory)?'*' : ''}" />
													
													<h:outputText
														value="#{cmsPropertyWrapper.localizedLabelForCurrentLocale}"/>
												</a4j:commandLink>
												
												
												
												<ui:fragment rendered="#{cmsPropertyWrapper.valueType ne 'Complex' 
																	or cmsPropertyWrapper.multiple}">
												<!-- Label all other cms properties -->
													<h:outputText 
														value="#{(cmsPropertyWrapper.mandatory)?'*' : ''}" />
														
													<h:outputText
														value="#{cmsPropertyWrapper.localizedLabelForCurrentLocale}"/>
												</ui:fragment>
												
												
												<ui:remove><img id="#{cmsPropertyWrapper.cmsPropertyDefinition.fullPath}" class="tipImg" src="images/cms-icons/12/info.png"/></ui:remove>
												<div class="#{cmsPropertyWrapper.cmsPropertyDefinition.fullPath}"></div>
												
											</label>
										
										
											<!--  If user has no access we do not show any value 
											<h:outputText
												rendered="#{ !cmsPropertyWrapper.readGranted and ! cmsPropertyWrapper.writeGranted}"
												value="Δεν επιτρέπεται η ενημέρωση του στοιχείου"
												/>
											-->
												
											<!-- upload a file for a single or multiple value binary property -->
											<ui:include
												src="/WEB-INF/pageComponents/edit/binaryProperty/binaryProperty.xhtml">
												<!--  Need to pass valueWrapper to xhtml to render its value -->
												<ui:param name="cmsPropertyWrapper"
													value="#{cmsPropertyWrapper}" />
												<ui:param name="indexOfCmsPropertyWrapper"
													value="#{indexOfCmsPropertyWrapper}" />
											</ui:include>
										
					
											<!-- Property with a single and simple value -->
											<a4j:outputPanel
												rendered="#{cmsPropertyWrapper.writeGranted and
												!cmsPropertyWrapper.multiple and 
												cmsPropertyWrapper.valueType ne 'Binary' and 
												cmsPropertyWrapper.valueType ne 'Complex' and 
												cmsPropertyWrapper.valueType ne 'TopicReference' and 
												cmsPropertyWrapper.valueType ne 'ObjectReference'}"
												keepTransient="true">
											
												<ui:include
													src="/WEB-INF/pageComponents/edit/simpleTypeValue.xhtml">
													<!--  Need to pass valueWrapper to xhtml to render its value -->
													<ui:param name="simpleCmsPropertyValueWrapper"
														value="#{cmsPropertyWrapper.singleSimpleCmsPropertyValueWrapper}" />
												</ui:include>
											</a4j:outputPanel>
											
											<!-- Property with Multiple Simple Values-->
											<ui:include
												src="/WEB-INF/pageComponents/edit/simpleTypeValues.xhtml">
												<!--  Need to pass valueWrapper to xhtml to render its value -->
												<ui:param name="cmsPropertyWrapper"
													value="#{cmsPropertyWrapper}" />
											</ui:include>
									
											<!-- TOPIC property with single or multiple values-->
											<ui:include
												src="/WEB-INF/pageComponents/edit/topicReferenceProperty/topicReferenceProperty.xhtml">
													<!--  Need to pass valueWrapper to xhtml to render its value -->
													<ui:param name="topicPropertyWrapper"
														value="#{cmsPropertyWrapper}" />
											</ui:include>
									
											<!-- Object Reference Property with single or multiple values -->
											<ui:include
												src="/WEB-INF/pageComponents/edit/objectReferenceProperty/objectReferenceProperty.xhtml">
													<!--  Need to pass valueWrapper to xhtml to render its value -->
													<ui:param name="cmsPropertyWrapper"
														value="#{cmsPropertyWrapper}" />
											</ui:include>
											
											<!-- "Add one more value" Action for a Complex Property with multiple values -->
											<a4j:commandLink
												onclick="destroyTextEditor();"
												rendered="#{
													cmsPropertyWrapper.writeGranted and cmsPropertyWrapper.multiple and  
													cmsPropertyWrapper.valueType eq 'Complex'}"
												action="#{cmsPropertyWrapper.addBlankValue_UIAction}"
												reRender="profilePropertiesPanel, complexCmsPropertyBreadCrumbs"
												
												title="Add a new #{cmsPropertyWrapper.valueType eq 'Binary' ? ' binary file path' : ' new value'}">
												<h:graphicImage value="/images/cms-icons/16/add1.png" />
											</a4j:commandLink>
											<!-- Values Of a Complex Property with multiple values -->
											<ui:include
												src="/WEB-INF/pageComponents/edit/complexPropertyValues.xhtml">
													<!--  Need to pass valueWrapper to xhtml to render its value -->
													<ui:param name="parentComplexCmsPropertyWrapper"
														value="#{cmsPropertyWrapper}" />
											</ui:include>
					
					
											<!-- Delete Action for single-value non mandatory complex cms properties NOT ASPECTS 
											    exclude profile, accessibility-->
											<a4j:commandLink
												onclick="destroyTextEditor(); codeEditorAreas=[]; editAreaLoader.prepare_areas_for_betacms_submit('dynamicAreaForm');"
												rendered="#{cmsPropertyWrapper.writeGranted and
												    ! empty cmsPropertyWrapper.cmsProperty and  
													! cmsPropertyWrapper.multiple and 
													! cmsPropertyWrapper.mandatory and 
													cmsPropertyWrapper.valueType eq 'Complex' and 
													cmsPropertyWrapper.definitionName ne 'profile' and
													cmsPropertyWrapper.definitionName ne 'accessibility' and
													! cmsPropertyWrapper.aspect}"
												
												action="#{cmsPropertyWrapper.deleteSingleValue_UIAction}"
												reRender="profilePropertiesPanel">
												<h:graphicImage value="/images/cms-icons/16/deleteTag.png" />
											</a4j:commandLink>
											
											<!-- Delete Action for multi-value non mandatory complex cms properties NOT ASPECTS 
											    exclude profile, accessibility-->
											<a4j:commandLink
												onclick="destroyTextEditor(); codeEditorAreas=[]; editAreaLoader.prepare_areas_for_betacms_submit('dynamicAreaForm');"
												rendered="#{cmsPropertyWrapper.writeGranted and
												    ! empty cmsPropertyWrapper.cmsProperty and  
													cmsPropertyWrapper.multiple and 
													! cmsPropertyWrapper.mandatory and 
													cmsPropertyWrapper.valueType eq 'Complex' and 
													cmsPropertyWrapper.definitionName ne 'profile' and
													cmsPropertyWrapper.definitionName ne 'accessibility' and
													! cmsPropertyWrapper.aspect and
													cmsPropertyWrapper.childComplexCmsPropertyWrappers.size() > 1}"
												action="#{confirmationBean.initiateConfirmation('content.object.edit.multiple.complex.cms.property.delete.question',
																cmsPropertyWrapper, 
																'deleteAllChildComplexCmsProperties_UIAction',
																cmsPropertyWrapper.localizedLabelForCurrentLocale, 
																'profilePropertiesPanel,complexCmsPropertyBreadCrumbs',
																null,
																null)}"
													 oncomplete="openConfirmationDialog();"
													 reRender="confirmationDialogPanel">
												<h:graphicImage value="/images/cms-icons/16/deleteTag.png" />
											</a4j:commandLink>
										</li>	
									
							</ui:fragment>
						</a4j:outputPanel>
					</a4j:repeat>

		</ui:composition>
		
		
		
	</body>
</html>
